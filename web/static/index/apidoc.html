<!--A Design by W3layouts
Author: W3layout
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>开发文档</title>
<link href="./css/bootstrap.css" rel='stylesheet' type='text/css' />
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="./js/jquery.min.js"></script>
<!-- Custom Theme files -->
<link href="./css/style.css" rel='stylesheet' type='text/css' />
<link href='./css/fonts.css' rel='stylesheet' type='text/css'>
<!-- Custom Theme files -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
</head>
<body>
	<!--- Header Starts Here --->
	<div class="header">
		<div class="container">
			<div class="logo">
				<a href="index.html"><img src="./images/logo.png" alt=""/></a>
			</div>
			<div class="navigation">
				<span class="menu"><img src="./images/nav.png" alt="" /></span>
				<ul class="nav">
					<li><a href="index.html">首页</a></li> <lable>/</lable>
					<li><a href="apidoc.html">开发文档</a></li> <lable>/</lable>
					<li><a href="errorcode.html">错误代码</a></li> <lable>/</lable>
					<li><a href="apidownload.html">API示例代码下载</a></li> <lable>/</lable>
					<li><a href="webdoc.html">网站后台使用文档</a></li> <lable>/</lable>
					<li><a href="http://www.kqdama.com:8080/login" target="_blank">后台登陆</a></li>
					<li><a href="price.html">价格表</a></li>
				</ul>
			</div>
			<script>
					$( "span.menu" ).click(function() {
					  $( ".navigation ul.nav" ).slideToggle( "slow", function() {
					    // Animation complete.
					  });
					});
				</script>
			<div class="clearfix"> </div>
		</div>
	</div>
	<!-- Content starts Here --->
	<div class="content">
		<div class="container">
			<span class="line"></span><a href="#" class="line-anchor">API接入流程（必看！）</a><span class="line"></span>
				<div class="clearfix"></div>
			<div class="content-middle">
				

<ol data-anchor-id="m17m">
<li>作者打开<a href="http://www.kqdama.com:8080/login" target="_blank">http://www.kqdama.com:8080/login</a>登陆管理平台</li>
<li>作者打开“常用功能-&gt;账户充值”进行充值。 <br>
<strong><em>说明</em></strong><em>：首先选择相应充值金额和点击“去支付宝充值”，充值成功后复制本次充值的<strong>交易号或流水号（不是订单号）</strong>，在页面下方提交即可，在交易明细中可以查看本次充值是否成功。</em></li>
<li>充值成功后打开“常用功能-&gt;账户信息”查看自己的调用次数和令牌。</li>
<li>作者新建一个子账户，并在“子账户操作-&gt;查看子账户-&gt;修改”中，分配给子账户一定的调用次数。</li>
<li>调用 <br>
<code>long captcha(char* imagefile, char* userna, char* passwd，char* token, char* result)</code> <br>
或 <br>
<code>long captcha_stream(unsigned char* image,long length, char* userna, char* passwd, char* token, char* result)</code>函数进行打码识别，识别错误时使用<code>long captchaError(char* userna, char* passwd，char* token, int codeID)</code>进行汇报错误，系统会恢复相应的码数。此时即接入成功。 <br>
<em>说明：此为dll函数原型，具体使用请参考各个编程语言示例。</em></li>
</ol>

<h3 id="注意事项" data-anchor-id="apg0"><strong>注意事项：</strong></h3>

<p data-anchor-id="id82">1.本平台账户类型分为<strong>“作者账户”和"子账户"</strong>，“作者账户”在<a href="http://221.206.124.211:8080/reg" target="_blank">http://221.206.124.211:8080/reg</a>页面注册，“子账户”必须由“作者账户”来创建。 <br>
2.作者创建子账户后，可以对自己的子账户进行管理，比如新加、删除、修改。作者可以将自己的剩余调用次数分配给子账户，比如给某一个子账户分配1000次，那么作者账户同时减少1000次，前提是作者的剩余调用次数必须大于等于1000次，否则将报错。 <br>
3.作者账户有一个专属的<strong>令牌</strong>，格式为一串没有空格的字符串，可以在网站<strong>“管理后台-&gt;常用功能-&gt;账户信息”</strong>中查看，在进行打码识别时需要把此令牌作为参数传递。在“账户信息”页面中，有可以更新令牌的按钮，点击后，可以更新自己的令牌。 <br>
3.<strong>“作者账户”不能进行打码识别，只有子用户才可以进行打码识别。</strong>如果作者需要进行打码识别，请自己建立子账户。 <br>
4.在进行识别时，该函数long captcha(char* imagefile, char* userna, char* passwd，char* token, char* result)传递的参数依次为“图片路径，<strong>子用户用户名，子用户密码，作者用户令牌</strong>,保存的返回值”，格式都是字符串。 <br>
<strong>5.取得验证码返回结果时，需判断结果是否是以“10”开头的错误代码，如果返回的是错误代码，则系统不会进行扣码，此时不需要调用汇报错误接口；如果没有返回错误代码，则系统会自动扣码，之后作者自行判断此次结果是否正确，如果不正确，则调用汇报错误接口，系统会恢复码数。</strong></p>

			</div>
			<span class="line"></span><a href="#" class="line-anchor">API开发文档</a><span class="line"></span>
				<div class="clearfix"></div>
				<div class="content-bottom">
					<h3 id="函数原型说明" data-anchor-id="pt7p"><strong>函数原型说明</strong></h3>

<div class="md-section-divider"></div>

<pre class="prettyprint linenums prettyprinted" data-anchor-id="1go1"><ol class="linenums"><li class="L0"><code class="language-C"><span class="com">///</span></code></li><li class="L1"><code class="language-C"><span class="com">/// 基本功能API</span></code></li><li class="L2"><code class="language-C"><span class="com">/// 提供识别接口、汇报接口、子用户添加、查询信息、登录等基本操作</span></code></li><li class="L3"><code class="language-C"><span class="com">/// 只需提供作者令牌，不需要作者用户名和密码，安全性高</span></code></li><li class="L4"><code class="language-C"><span class="com">///</span></code></li><li class="L5"><code class="language-C"><span class="com">//</span></code></li><li class="L6"><code class="language-C"><span class="com">//识别相关函数</span></code></li><li class="L7"><code class="language-C"><span class="com">//</span></code></li><li class="L8"><code class="language-C"><span class="com">/**</span></code></li><li class="L9"><code class="language-C"><span class="com">识别函数</span></code></li><li class="L0"><code class="language-C"><span class="com">*/</span></code></li><li class="L1"><code class="language-C"><span class="kwd">int</span><span class="pln"> captcha</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> imagefile</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">，</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> token</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> result</span><span class="pun">)</span></code></li><li class="L2"><code class="language-C"><span class="com">/**</span></code></li><li class="L3"><code class="language-C"><span class="com">传递字节流识别函数</span></code></li><li class="L4"><code class="language-C"><span class="com">*/</span></code></li><li class="L5"><code class="language-C"><span class="kwd">int</span><span class="pln"> captcha_stream</span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> imagefile</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> byteLength</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">，</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> token</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> result</span><span class="pun">)</span></code></li><li class="L6"><code class="language-C"><span class="com">/**</span></code></li><li class="L7"><code class="language-C"><span class="com">告知系统识别结果错误</span></code></li><li class="L8"><code class="language-C"><span class="com">*/</span></code></li><li class="L9"><code class="language-C"><span class="kwd">long</span><span class="pln"> captchaError</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">，</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> token</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> codeID</span><span class="pun">)</span></code></li><li class="L0"><code class="language-C"><span class="com">//</span></code></li><li class="L1"><code class="language-C"><span class="com">//子用户操作相关函数</span></code></li><li class="L2"><code class="language-C"><span class="com">//</span></code></li><li class="L3"><code class="language-C"><span class="com">/**</span></code></li><li class="L4"><code class="language-C"><span class="com">添加子用户</span></code></li><li class="L5"><code class="language-C"><span class="com">*/</span></code></li><li class="L6"><code class="language-C"><span class="kwd">long</span><span class="pln"> addsubuser</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> token</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subusername</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subpasswd</span><span class="pun">);</span></code></li><li class="L7"><code class="language-C"><span class="com">/**</span></code></li><li class="L8"><code class="language-C"><span class="com">查询指定子用户信息</span></code></li><li class="L9"><code class="language-C"><span class="com">*/</span></code></li><li class="L0"><code class="language-C"><span class="kwd">void</span><span class="pln"> querysubuser</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> token</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subusername</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> result</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> length</span><span class="pun">);</span></code></li><li class="L1"><code class="language-C"><span class="com">/**</span></code></li><li class="L2"><code class="language-C"><span class="com">登陆指定子用户</span></code></li><li class="L3"><code class="language-C"><span class="com">*/</span></code></li><li class="L4"><code class="language-C"><span class="kwd">long</span><span class="pln"> loginsubuser</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> token</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subusername</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subpasswd</span><span class="pun">);</span></code></li><li class="L5"><code class="language-C"></code></li><li class="L6"><code class="language-C"><span class="com">///</span></code></li><li class="L7"><code class="language-C"><span class="com">/// 作者控制API</span></code></li><li class="L8"><code class="language-C"><span class="com">/// 提供作者信息查看、所属子用户查看、删除、修改子用户等功能</span></code></li><li class="L9"><code class="language-C"><span class="com">/// 需要提供作者用户名和密码，主要用于作者编写自己的用户控制软件，请谨慎在分发给子用户的软件中使用下列API</span></code></li><li class="L0"><code class="language-C"><span class="com">///</span></code></li><li class="L1"><code class="language-C"><span class="com">/**</span></code></li><li class="L2"><code class="language-C"><span class="com">删除指定子用户</span></code></li><li class="L3"><code class="language-C"><span class="com">*/</span></code></li><li class="L4"><code class="language-C"><span class="kwd">long</span><span class="pln"> delsubuser</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subusername</span><span class="pun">);</span></code></li><li class="L5"><code class="language-C"><span class="com">/**</span></code></li><li class="L6"><code class="language-C"><span class="com">修改指定子用户</span></code></li><li class="L7"><code class="language-C"><span class="com">*/</span></code></li><li class="L8"><code class="language-C"><span class="kwd">long</span><span class="pln"> modsubuser</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subusername</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subpasswd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> subdeltcount</span><span class="pun">);</span></code></li><li class="L9"><code class="language-C"><span class="com">/**</span></code></li><li class="L0"><code class="language-C"><span class="com">查询该作者账户下所有子用户</span></code></li><li class="L1"><code class="language-C"><span class="com">*/</span></code></li><li class="L2"><code class="language-C"><span class="kwd">void</span><span class="pln"> queryallsubuser</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> result</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> length</span><span class="pun">);</span></code></li><li class="L3"><code class="language-C"><span class="com">/**</span></code></li><li class="L4"><code class="language-C"><span class="com">查询作者用户信息</span></code></li><li class="L5"><code class="language-C"><span class="com">*/</span></code></li><li class="L6"><code class="language-C"><span class="kwd">void</span><span class="pln"> queryuserinfo</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> result</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> length</span><span class="pun">);</span></code></li></ol></pre>

<div class="md-section-divider"></div>

<h3 id="调用流程" data-anchor-id="3ivq"><strong>调用流程</strong></h3>

<ol data-anchor-id="iej1">
<li>调用codeID=captcha(imagefile, userna, passwd，token, result)进行识别，获取识别结果和相应的验证码ID。如果识别结果不是以“10”开头的错误代码，则系统默认识别正确，会扣掉相应的码数，同时返回相应的验证码codeID。如果识别结果是以“10”开头的错误代码，则系统不会扣码，同时返回的codeID为0。</li>
<li>用户判断识别结果是否正确，如果正确，则不用做任何操作；如果错误，则调用captchaError(userna, passwd, token, codeID)进行汇报错误，系统会返回对应的码数</li>
</ol>

<div class="md-section-divider"></div>

<h3 id="注意每次调用captchaerror都需要传递相应的codeid同一个codeid不能汇报多次" data-anchor-id="d6rm"><strong>注意：每次调用captchaError都需要传递相应的codeID，同一个codeID不能汇报多次！</strong></h3>

<div class="md-section-divider"></div>

<h3 id="函数原型详细说明" data-anchor-id="05ej"><strong>函数原型详细说明</strong></h3>

<div class="md-section-divider"></div>

<pre class="prettyprint linenums prettyprinted" data-anchor-id="kukl"><ol class="linenums"><li class="L0"><code class="language-C++"><span class="com">/**</span></code></li><li class="L1"><code class="language-C++"><span class="com">函数用途：</span></code></li><li class="L2"><code class="language-C++"><span class="com">    对一个图像进行识别</span></code></li><li class="L3"><code class="language-C++"><span class="com">参数说明：</span></code></li><li class="L4"><code class="language-C++"><span class="com">    imagefile:要识别的图片的路径</span></code></li><li class="L5"><code class="language-C++"><span class="com">    userna:子用户用户名</span></code></li><li class="L6"><code class="language-C++"><span class="com">    passwd:子用户密码</span></code></li><li class="L7"><code class="language-C++"><span class="com">    token:作者用户的令牌</span></code></li><li class="L8"><code class="language-C++"><span class="com">    result:返回来的验证码识别结果   （必须为验证码识别结果申请20字节的存放空间!）</span></code></li><li class="L9"><code class="language-C++"><span class="com">result正确值：</span></code></li><li class="L0"><code class="language-C++"><span class="com">    识别出的字符，例如ABCD</span></code></li><li class="L1"><code class="language-C++"><span class="com">result错误值：</span></code></li><li class="L2"><code class="language-C++"><span class="com">    1001:用户名或密码错误</span></code></li><li class="L3"><code class="language-C++"><span class="com">    1002:需要充值</span></code></li><li class="L4"><code class="language-C++"><span class="com">    1003:传递的参数错误</span></code></li><li class="L5"><code class="language-C++"><span class="com">    1004:其他错误</span></code></li><li class="L6"><code class="language-C++"><span class="com">返回值：</span></code></li><li class="L7"><code class="language-C++"><span class="com">    codeID，验证码唯一ID</span></code></li><li class="L8"><code class="language-C++"><span class="com">*/</span></code></li><li class="L9"><code class="language-C++"><span class="kwd">int</span><span class="pln"> captcha</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> imagefile</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">，</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> token</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> result</span><span class="pun">)</span></code></li><li class="L0"><code class="language-C++"><span class="com">/**</span></code></li><li class="L1"><code class="language-C++"><span class="com">函数用途：</span></code></li><li class="L2"><code class="language-C++"><span class="com">    传递图片字节流对一个图像进行识别</span></code></li><li class="L3"><code class="language-C++"><span class="com">参数说明：</span></code></li><li class="L4"><code class="language-C++"><span class="com">    imagefile:要识别的图片的字节流</span></code></li><li class="L5"><code class="language-C++"><span class="com">    bytelength:字节流的大小</span></code></li><li class="L6"><code class="language-C++"><span class="com">    userna:子用户用户名</span></code></li><li class="L7"><code class="language-C++"><span class="com">    passwd:子用户密码</span></code></li><li class="L8"><code class="language-C++"><span class="com">    token:作者用户的令牌</span></code></li><li class="L9"><code class="language-C++"><span class="com">    result:返回来的验证码识别结果   （必须为验证码识别结果申请20字节的存放空间!）</span></code></li><li class="L0"><code class="language-C++"><span class="com">result正确值：</span></code></li><li class="L1"><code class="language-C++"><span class="com">    识别出的字符，例如ABCD</span></code></li><li class="L2"><code class="language-C++"><span class="com">result错误值：</span></code></li><li class="L3"><code class="language-C++"><span class="com">    1001:用户名或密码错误</span></code></li><li class="L4"><code class="language-C++"><span class="com">    1002:需要充值</span></code></li><li class="L5"><code class="language-C++"><span class="com">    1003:传递的参数错误</span></code></li><li class="L6"><code class="language-C++"><span class="com">    1004:其他错误</span></code></li><li class="L7"><code class="language-C++"><span class="com">    1010:图片长度过大</span></code></li><li class="L8"><code class="language-C++"><span class="com">返回值：</span></code></li><li class="L9"><code class="language-C++"><span class="com">    codeID，验证码唯一ID</span></code></li><li class="L0"><code class="language-C++"><span class="com">*/</span></code></li><li class="L1"><code class="language-C++"><span class="kwd">int</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> captcha_stream</span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> imagefile</span><span class="pun">,</span><span class="kwd">long</span><span class="pln"> bytelength</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> token</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> result</span><span class="pun">)</span></code></li><li class="L2"><code class="language-C++"><span class="com">/**</span></code></li><li class="L3"><code class="language-C++"><span class="com">函数用途：</span></code></li><li class="L4"><code class="language-C++"><span class="com">    告知系统该次识别错误</span></code></li><li class="L5"><code class="language-C++"><span class="com">参数说明：</span></code></li><li class="L6"><code class="language-C++"><span class="com">    userna:子用户用户名</span></code></li><li class="L7"><code class="language-C++"><span class="com">    passwd:子用户密码</span></code></li><li class="L8"><code class="language-C++"><span class="com">    token:作者用户的令牌</span></code></li><li class="L9"><code class="language-C++"><span class="com">    codeID:captcha函数返回的codeID</span></code></li><li class="L0"><code class="language-C++"><span class="com">正确返回值：</span></code></li><li class="L1"><code class="language-C++"><span class="com">    0</span></code></li><li class="L2"><code class="language-C++"><span class="com">错误返回值：</span></code></li><li class="L3"><code class="language-C++"><span class="com">    1001:用户名或密码错误</span></code></li><li class="L4"><code class="language-C++"><span class="com">    1002:需要充值</span></code></li><li class="L5"><code class="language-C++"><span class="com">    1003:传递的参数错误</span></code></li><li class="L6"><code class="language-C++"><span class="com">    1004:其他错误</span></code></li><li class="L7"><code class="language-C++"><span class="com">    1014:codeID不存在</span></code></li><li class="L8"><code class="language-C++"><span class="com">    1015:该codeID已经汇报过一次错误了</span></code></li><li class="L9"><code class="language-C++"><span class="com">*/</span></code></li><li class="L0"><code class="language-C++"><span class="kwd">long</span><span class="pln"> captchaError</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">，</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> token</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> codeID</span><span class="pun">)</span></code></li><li class="L1"><code class="language-C++"></code></li><li class="L2"><code class="language-C++"><span class="com">//</span></code></li><li class="L3"><code class="language-C++"><span class="com">//子用户操作相关函数</span></code></li><li class="L4"><code class="language-C++"><span class="com">//</span></code></li><li class="L5"><code class="language-C++"><span class="com">/**</span></code></li><li class="L6"><code class="language-C++"><span class="com">函数用途：</span></code></li><li class="L7"><code class="language-C++"><span class="com">    添加子用户，子用户剩余调用次数（剩余码数）会被初始化为0</span></code></li><li class="L8"><code class="language-C++"><span class="com">参数说明：</span></code></li><li class="L9"><code class="language-C++"><span class="com">    token:作者用户令牌</span></code></li><li class="L0"><code class="language-C++"><span class="com">    subusername:子用户用户名</span></code></li><li class="L1"><code class="language-C++"><span class="com">    subpasswd:子用户密码</span></code></li><li class="L2"><code class="language-C++"><span class="com">正确返回值：</span></code></li><li class="L3"><code class="language-C++"><span class="com">    0</span></code></li><li class="L4"><code class="language-C++"><span class="com">错误返回值：</span></code></li><li class="L5"><code class="language-C++"><span class="com">    1001:作者令牌不存在</span></code></li><li class="L6"><code class="language-C++"><span class="com">    1006:该子用户名已存在</span></code></li><li class="L7"><code class="language-C++"><span class="com">*/</span></code></li><li class="L8"><code class="language-C++"><span class="kwd">long</span><span class="pln"> addsubuser</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> token</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subusername</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subpasswd</span><span class="pun">)</span></code></li><li class="L9"><code class="language-C++"><span class="com">/**</span></code></li><li class="L0"><code class="language-C++"><span class="com">函数用途：</span></code></li><li class="L1"><code class="language-C++"><span class="com">    查询指定子用户信息</span></code></li><li class="L2"><code class="language-C++"><span class="com">参数说明：</span></code></li><li class="L3"><code class="language-C++"><span class="com">    token:作者用户令牌</span></code></li><li class="L4"><code class="language-C++"><span class="com">    subusername:子用户用户名</span></code></li><li class="L5"><code class="language-C++"><span class="com">    result:保存结果的字符串，根据返回内容的大小，请至少预留100个字节的空间</span></code></li><li class="L6"><code class="language-C++"><span class="com">    length:result字符串的实际长度</span></code></li><li class="L7"><code class="language-C++"><span class="com">result正确值：</span></code></li><li class="L8"><code class="language-C++"><span class="com">    字符串，包含该用户的用户名，令牌，调用次数等信息，格式如下：</span></code></li><li class="L9"><code class="language-C++"><span class="com">    [u'USERNAME:username','LEFTCOUNT:0', 'CALLEDCOUNT:0', 'SUCCESSCOUNT:0'，char* result, long length]</span></code></li><li class="L0"><code class="language-C++"><span class="com">result错误值：</span></code></li><li class="L1"><code class="language-C++"><span class="com">    1001:作者用户名或密码错误</span></code></li><li class="L2"><code class="language-C++"><span class="com">    1007:子用户用户名错误</span></code></li><li class="L3"><code class="language-C++"><span class="com">*/</span></code></li><li class="L4"><code class="language-C++"><span class="kwd">void</span><span class="pln"> querysubuser</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> token</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subusername</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> result</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> length</span><span class="pun">)</span></code></li><li class="L5"><code class="language-C++"><span class="com">/**</span></code></li><li class="L6"><code class="language-C++"><span class="com">函数用途：</span></code></li><li class="L7"><code class="language-C++"><span class="com">    登陆指定子用户</span></code></li><li class="L8"><code class="language-C++"><span class="com">参数说明：</span></code></li><li class="L9"><code class="language-C++"><span class="com">    token:作者用户令牌</span></code></li><li class="L0"><code class="language-C++"><span class="com">    subusername:子用户用户名</span></code></li><li class="L1"><code class="language-C++"><span class="com">    subpasswd:子用户密码</span></code></li><li class="L2"><code class="language-C++"><span class="com">正确返回值：</span></code></li><li class="L3"><code class="language-C++"><span class="com">    0   登陆成功</span></code></li><li class="L4"><code class="language-C++"><span class="com">错误返回值：</span></code></li><li class="L5"><code class="language-C++"><span class="com">    1001:作者用户名或密码错误</span></code></li><li class="L6"><code class="language-C++"><span class="com">    1007:该子用户不存在</span></code></li><li class="L7"><code class="language-C++"><span class="com">    1008:子用户密码错误</span></code></li><li class="L8"><code class="language-C++"><span class="com">*/</span></code></li><li class="L9"><code class="language-C++"><span class="kwd">long</span><span class="pln"> loginsubuser</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> token</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subusername</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subpasswd</span><span class="pun">);</span></code></li><li class="L0"><code class="language-C++"></code></li><li class="L1"><code class="language-C++"><span class="com">///</span></code></li><li class="L2"><code class="language-C++"><span class="com">/// 作者控制API</span></code></li><li class="L3"><code class="language-C++"><span class="com">///</span></code></li><li class="L4"><code class="language-C++"><span class="com">/**</span></code></li><li class="L5"><code class="language-C++"><span class="com">函数用途：</span></code></li><li class="L6"><code class="language-C++"><span class="com">    删除指定子用户，删除用户后，该用户剩余的码数会返还到作者账户中</span></code></li><li class="L7"><code class="language-C++"><span class="com">参数说明：</span></code></li><li class="L8"><code class="language-C++"><span class="com">    userna:作者用户名</span></code></li><li class="L9"><code class="language-C++"><span class="com">    passwd:作者用户密码</span></code></li><li class="L0"><code class="language-C++"><span class="com">    subusername:子用户用户名</span></code></li><li class="L1"><code class="language-C++"><span class="com">正确返回值：</span></code></li><li class="L2"><code class="language-C++"><span class="com">    0   删除成功</span></code></li><li class="L3"><code class="language-C++"><span class="com">错误返回值：</span></code></li><li class="L4"><code class="language-C++"><span class="com">    1001:作者用户名或密码错误</span></code></li><li class="L5"><code class="language-C++"><span class="com">    1007:该子用户不存在</span></code></li><li class="L6"><code class="language-C++"><span class="com">*/</span></code></li><li class="L7"><code class="language-C++"><span class="kwd">long</span><span class="pln"> delsubuser</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subusername</span><span class="pun">);</span></code></li><li class="L8"><code class="language-C++"><span class="com">/**</span></code></li><li class="L9"><code class="language-C++"><span class="com">函数用途：</span></code></li><li class="L0"><code class="language-C++"><span class="com">    修改指定子用户</span></code></li><li class="L1"><code class="language-C++"><span class="com">参数说明：</span></code></li><li class="L2"><code class="language-C++"><span class="com">    userna:作者用户名</span></code></li><li class="L3"><code class="language-C++"><span class="com">    passwd:作者用户密码</span></code></li><li class="L4"><code class="language-C++"><span class="com">    subusername:子用户用户名</span></code></li><li class="L5"><code class="language-C++"><span class="com">    subpasswd:新的子用户密码，子用户新密码</span></code></li><li class="L6"><code class="language-C++"><span class="com">    subdeltcount:增加或减少的子用户码数，比如填写1000，则给子用户增加1000码数，填写-1000，则给字用户名减少1000码数</span></code></li><li class="L7"><code class="language-C++"><span class="com">正确返回值：</span></code></li><li class="L8"><code class="language-C++"><span class="com">    0   修改成功</span></code></li><li class="L9"><code class="language-C++"><span class="com">错误返回值：</span></code></li><li class="L0"><code class="language-C++"><span class="com">    1001:作者用户名或密码错误</span></code></li><li class="L1"><code class="language-C++"><span class="com">    1002:作者剩余码数不足</span></code></li><li class="L2"><code class="language-C++"><span class="com">    1007:该子用户不存在</span></code></li><li class="L3"><code class="language-C++"><span class="com">    1009:子用户码数不足</span></code></li><li class="L4"><code class="language-C++"><span class="com">*/</span></code></li><li class="L5"><code class="language-C++"><span class="kwd">long</span><span class="pln"> modsubuser</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subusername</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> subpasswd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> subdeltcount</span><span class="pun">);</span></code></li><li class="L6"><code class="language-C++"><span class="com">/**</span></code></li><li class="L7"><code class="language-C++"><span class="com">查询该作者账户下所有子用户</span></code></li><li class="L8"><code class="language-C++"><span class="com">参数说明：</span></code></li><li class="L9"><code class="language-C++"><span class="com">    userna:作者用户名</span></code></li><li class="L0"><code class="language-C++"><span class="com">    passwd:作者用户密码</span></code></li><li class="L1"><code class="language-C++"><span class="com">    result:保存结果的字符串，如果返回的内容被截断，请分配更大的空间</span></code></li><li class="L2"><code class="language-C++"><span class="com">    length:result字符串的实际长度</span></code></li><li class="L3"><code class="language-C++"><span class="com">result正确值：</span></code></li><li class="L4"><code class="language-C++"><span class="com">    字符串，包含作者用户下所有子用户的用户名，调用次数等信息，格式如下</span></code></li><li class="L5"><code class="language-C++"><span class="com">    [[u'USERNAME:username','LEFTCOUNT:0', 'CALLEDCOUNT:0', 'SUCCESSCOUNT:0'，char* result, long length],...]</span></code></li><li class="L6"><code class="language-C++"><span class="com">result错误值：</span></code></li><li class="L7"><code class="language-C++"><span class="com">    1001:作者用户名或密码错误</span></code></li><li class="L8"><code class="language-C++"><span class="com">*/</span></code></li><li class="L9"><code class="language-C++"><span class="kwd">void</span><span class="pln"> queryallsubuser</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> result</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> length</span><span class="pun">);</span></code></li><li class="L0"><code class="language-C++"><span class="com">/**</span></code></li><li class="L1"><code class="language-C++"><span class="com">查询作者用户信息</span></code></li><li class="L2"><code class="language-C++"><span class="com">参数说明：</span></code></li><li class="L3"><code class="language-C++"><span class="com">    userna:作者用户名</span></code></li><li class="L4"><code class="language-C++"><span class="com">    passwd:作者用户密码</span></code></li><li class="L5"><code class="language-C++"><span class="com">    result:保存结果的字符串，如果返回的内容被截断，请分配更大的空间</span></code></li><li class="L6"><code class="language-C++"><span class="com">    length:result字符串的实际长度</span></code></li><li class="L7"><code class="language-C++"><span class="com">result正确值：</span></code></li><li class="L8"><code class="language-C++"><span class="com">    字符串，包含作者用户名，令牌，调用次数等信息，格式如下</span></code></li><li class="L9"><code class="language-C++"><span class="com">    [[u'USERNAME:username','LEFTCOUNT:0', 'CALLEDCOUNT:0', 'SUCCESSCOUNT:0'，char* result, long length],...]</span></code></li><li class="L0"><code class="language-C++"><span class="com">result错误值：</span></code></li><li class="L1"><code class="language-C++"><span class="com">    1001:作者用户名或密码错误</span></code></li><li class="L2"><code class="language-C++"><span class="com">*/</span></code></li><li class="L3"><code class="language-C++"><span class="kwd">void</span><span class="pln"> queryuserinfo</span><span class="pun">(</span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> userna</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> passwd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*</span><span class="pln"> result</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> length</span><span class="pun">);</span></code></li></ol></pre>


				</div>
				
		</div>
	</div>
	
</body>
</html>